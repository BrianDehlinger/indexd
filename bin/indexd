#!/usr/bin/env python

import flask

from indexd.index.blueprint import blueprint as indexd_index_blueprint
from indexd.alias.blueprint import blueprint as indexd_alias_blueprint

from indexd.index.drivers.sqlalchemy import SQLAlchemyIndexDriver
from indexd.alias.sqlite import SQLiteAliasDriver


if __name__ == '__main__':
    
    app = flask.Flask(__name__)

    app.config['JSONIFY_PRETTYPRINT_REGULAR'] = False

    app.config['INDEX'] = {
        'driver':  SQLAlchemyIndexDriver('sqlite:///index.sq3'),
    }

    app.config['ALIAS'] = {
        'driver': SQLiteAliasDriver,
        'SQLITE3': {
            'host': 'alias.sq3',
        }
    }

    app.register_blueprint(indexd_index_blueprint)
    app.register_blueprint(indexd_alias_blueprint)

    app.run(
        host='0.0.0.0',
        port=8080,
        debug=True,
        threaded=True,
    )
